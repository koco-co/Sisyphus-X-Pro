# AUTH æ¨¡å— E2E æµ‹è¯•å®æ–½æ€»ç»“

## ğŸ“Š æµ‹è¯•è¦†ç›–æ¦‚è§ˆ

### æµ‹è¯•ç»Ÿè®¡
- **æ€»æµ‹è¯•ç”¨ä¾‹**: 18 ä¸ª AUTH ç›¸å…³æµ‹è¯•
- **Page Objects**: 2 ä¸ª (AuthPage, DashboardPage)
- **æµ‹è¯•è¾…åŠ©å·¥å…·**: API Helper, Health Check
- **æ–‡æ¡£**: README, TEST_GUIDE

### åŠŸèƒ½è¦†ç›–

| åŠŸèƒ½ ID | åŠŸèƒ½åç§° | æµ‹è¯•ç”¨ä¾‹æ•° | çŠ¶æ€ |
|---------|---------|-----------|------|
| AUTH-001 | ç”¨æˆ·æ³¨å†Œ | 4 | âœ… å®Œæˆ |
| AUTH-002 | é‚®ç®±å¯†ç ç™»å½• | 4 | âœ… å®Œæˆ |
| AUTH-003 | GitHub OAuth | 1 | âœ… éƒ¨åˆ†å®Œæˆ (æŒ‰é’®æµ‹è¯•) |
| AUTH-004 | Google OAuth | 1 | âœ… éƒ¨åˆ†å®Œæˆ (æŒ‰é’®æµ‹è¯•) |
| AUTH-005 | é€€å‡ºç™»å½• | 2 | âœ… å®Œæˆ |
| AUTH-007 | å¯†ç åŠ å¯† | 1 | âœ… å®Œæˆ |
| AUTH-008 | è´¦æˆ·é”å®š | 2 | âœ… å®Œæˆ |

## ğŸ“ æ–‡ä»¶ç»“æ„

```
frontend/
â”œâ”€â”€ playwright.config.ts           # Playwright é…ç½®
â”œâ”€â”€ package.json                   # æ·»åŠ æµ‹è¯•è„šæœ¬
â”œâ”€â”€ tests/
â”‚   â””â”€â”€ e2e/
â”‚       â”œâ”€â”€ auth.spec.ts           # AUTH æ¨¡å— E2E æµ‹è¯• â­
â”‚       â”œâ”€â”€ example.spec.ts        # ç¤ºä¾‹æµ‹è¯•
â”‚       â”œâ”€â”€ pages/
â”‚       â”‚   â”œâ”€â”€ AuthPage.ts        # è®¤è¯é¡µé¢å¯¹è±¡
â”‚       â”‚   â””â”€â”€ DashboardPage.ts   # é¦–é¡µé¢å¯¹è±¡
â”‚       â”œâ”€â”€ helpers/
â”‚       â”‚   â”œâ”€â”€ api-helper.ts      # API è¾…åŠ©å‡½æ•°
â”‚       â”‚   â”œâ”€â”€ test-setup.ts      # æµ‹è¯•è®¾ç½®
â”‚       â”‚   â””â”€â”€ health-check.ts    # å¥åº·æ£€æŸ¥è„šæœ¬
â”‚       â”œâ”€â”€ fixtures/
â”‚       â”‚   â””â”€â”€ test-data.ts       # æµ‹è¯•æ•°æ® fixtures
â”‚       â”œâ”€â”€ README.md              # E2E æµ‹è¯•æ–‡æ¡£
â”‚       â”œâ”€â”€ TEST_GUIDE.md          # è¯¦ç»†æµ‹è¯•æŒ‡å— â­
â”‚       â””â”€â”€ TEST_SUMMARY.md        # æœ¬æ–‡æ¡£
```

## ğŸ¯ æµ‹è¯•åœºæ™¯è¯¦ç»†è¯´æ˜

### AUTH-001: ç”¨æˆ·æ³¨å†Œ (4 ä¸ªæµ‹è¯•)

#### 1. åº”è¯¥æˆåŠŸæ³¨å†Œæ–°ç”¨æˆ·
- **éªŒè¯ç‚¹**:
  - æ³¨å†Œåè·³è½¬åˆ°é¦–é¡µæˆ–ç™»å½•é¡µ
  - Token å­˜å…¥ localStorage
- **æ¸…ç†**: æµ‹è¯•åè‡ªåŠ¨åˆ é™¤ç”¨æˆ·

#### 2. åº”è¯¥æ‹’ç»é‡å¤æ³¨å†Œç›¸åŒé‚®ç®±
- **éªŒè¯ç‚¹**:
  - æ˜¾ç¤º"é‚®ç®±å·²å­˜åœ¨"é”™è¯¯
- **æ¸…ç†**: åˆ é™¤æµ‹è¯•ç”¨æˆ·

#### 3. åº”è¯¥éªŒè¯å¯†ç å¼ºåº¦
- **æµ‹è¯•æ•°æ®**: å¯†ç  "123" (å¤ªå¼±)
- **éªŒè¯ç‚¹**: æ˜¾ç¤ºå¯†ç å¼ºåº¦é”™è¯¯

#### 4. åº”è¯¥éªŒè¯é‚®ç®±æ ¼å¼
- **æµ‹è¯•æ•°æ®**: "invalid-email"
- **éªŒè¯ç‚¹**: æ˜¾ç¤ºé‚®ç®±æ ¼å¼é”™è¯¯

---

### AUTH-002: é‚®ç®±å¯†ç ç™»å½• (4 ä¸ªæµ‹è¯•)

#### 1. åº”è¯¥æˆåŠŸç™»å½•å¹¶è·³è½¬åˆ°é¦–é¡µ
- **éªŒè¯ç‚¹**:
  - è·³è½¬åˆ°é¦–é¡µ
  - æ˜¾ç¤ºç”¨æˆ·é‚®ç®±
  - Token å­˜å…¥ localStorage
- **æµ‹è¯•æµç¨‹**:
  1. åˆ›å»ºæµ‹è¯•ç”¨æˆ·
  2. æ‰§è¡Œç™»å½•
  3. éªŒè¯è·³è½¬
  4. éªŒè¯ UI çŠ¶æ€
  5. éªŒè¯ localStorage

#### 2. åº”è¯¥æ‹’ç»é”™è¯¯å¯†ç ç™»å½•
- **æµ‹è¯•æ•°æ®**: æ­£ç¡®é‚®ç®± + é”™è¯¯å¯†ç 
- **éªŒè¯ç‚¹**:
  - æ˜¾ç¤ºå¯†ç é”™è¯¯æ¶ˆæ¯
  - ä»ç„¶åœ¨ç™»å½•é¡µ
  - æ—  token

#### 3. åº”è¯¥æ‹’ç»æœªæ³¨å†Œé‚®ç®±ç™»å½•
- **æµ‹è¯•æ•°æ®**: ä¸å­˜åœ¨çš„é‚®ç®±
- **éªŒè¯ç‚¹**:
  - æ˜¾ç¤º"ç”¨æˆ·ä¸å­˜åœ¨"é”™è¯¯
  - æ—  token

#### 4. åº”è¯¥æ˜¾ç¤ºéªŒè¯é”™è¯¯ï¼ˆç©ºå­—æ®µï¼‰
- **æµ‹è¯•åœºæ™¯**: æäº¤ç©ºè¡¨å•
- **éªŒè¯ç‚¹**: æ˜¾ç¤ºéªŒè¯é”™è¯¯

---

### AUTH-005: é€€å‡ºç™»å½• (2 ä¸ªæµ‹è¯•)

#### 1. åº”è¯¥æˆåŠŸé€€å‡ºå¹¶æ¸…é™¤ token
- **æµ‹è¯•æµç¨‹**:
  1. å…ˆç™»å½•
  2. ç‚¹å‡»é€€å‡º
  3. éªŒè¯è·³è½¬åˆ°ç™»å½•é¡µ
  4. éªŒè¯ token æ¸…é™¤

#### 2. é€€å‡ºåä¸åº”è¯¥èƒ½è®¿é—®å—ä¿æŠ¤é¡µé¢
- **æµ‹è¯•æµç¨‹**:
  1. ç™»å½• â†’ é€€å‡º
  2. ç›´æ¥è®¿é—®é¦–é¡µ
  3. éªŒè¯é‡å®šå‘åˆ°ç™»å½•é¡µ

---

### AUTH-007: å¯†ç åŠ å¯† (1 ä¸ªæµ‹è¯•)

#### æ³¨å†Œåå¯†ç åº”è¯¥æ˜¯ bcrypt å“ˆå¸Œ
- **éªŒè¯ç‚¹**:
  - API å“åº”ä¸åŒ…å«å¯†ç å­—æ®µ
  - æ³¨å†ŒæˆåŠŸå“åº”ä¸æ³„éœ²å¯†ç 
- **æ³¨æ„**: å®Œæ•´çš„ bcrypt éªŒè¯éœ€è¦æ•°æ®åº“è®¿é—®æƒé™

---

### AUTH-008: è´¦æˆ·é”å®šæœºåˆ¶ (2 ä¸ªæµ‹è¯•)

#### 1. 5æ¬¡é”™è¯¯å¯†ç ååº”è¯¥é”å®šè´¦æˆ·
- **æµ‹è¯•æµç¨‹**:
  1. æ‰§è¡Œ 5 æ¬¡é”™è¯¯ç™»å½•
  2. ç¬¬ 6 æ¬¡æ˜¾ç¤º"è´¦æˆ·é”å®š"é”™è¯¯
  3. ä½¿ç”¨æ­£ç¡®å¯†ç ä¹Ÿæ— æ³•ç™»å½•

#### 2. æ­£ç¡®ç™»å½•åº”è¯¥é‡ç½®å¤±è´¥è®¡æ•°
- **æµ‹è¯•æµç¨‹**:
  1. 3 æ¬¡é”™è¯¯ç™»å½•
  2. æ­£ç¡®ç™»å½• (é‡ç½®è®¡æ•°)
  3. å†æ¬¡ 5 æ¬¡é”™è¯¯ç™»å½•
  4. éªŒè¯å†æ¬¡é”å®š

---

### AUTH-003 & AUTH-004: OAuth ç™»å½• (2 ä¸ªæµ‹è¯•)

#### 1. GitHub OAuth æŒ‰é’®åº”è¯¥å­˜åœ¨å¹¶å¯ç‚¹å‡»
- **éªŒè¯ç‚¹**:
  - æŒ‰é’®å¯è§
  - ç‚¹å‡»åè·³è½¬åˆ° GitHub

#### 2. Google OAuth æŒ‰é’®åº”è¯¥å­˜åœ¨å¹¶å¯ç‚¹å‡»
- **éªŒè¯ç‚¹**:
  - æŒ‰é’®å¯è§
  - ç‚¹å‡»åè·³è½¬åˆ° Google

**æ³¨æ„**: å®Œæ•´ OAuth æµç¨‹æµ‹è¯•å·²è·³è¿‡,éœ€è¦:
- çœŸå®çš„ OAuth åº”ç”¨é…ç½®
- æµ‹è¯•è´¦æˆ·
- æˆ– mock OAuth æœåŠ¡å™¨

## ğŸš€ è¿è¡Œæµ‹è¯•

### å¿«é€Ÿå¼€å§‹

```bash
# 1. å¯åŠ¨åç«¯æœåŠ¡
cd backend
uvicorn app.main:app --reload

# 2. è¿è¡Œ E2E æµ‹è¯•
cd frontend
npm run test:e2e
```

### å…¶ä»–å‘½ä»¤

```bash
# UI æ¨¡å¼ (æ¨èç”¨äºè°ƒè¯•)
npm run test:e2e:ui

# è°ƒè¯•æ¨¡å¼
npm run test:e2e:debug

# åªè¿è¡Œ AUTH æµ‹è¯•
npx playwright test auth.spec

# è¿è¡Œç‰¹å®šæµ‹è¯•
npx playwright test -g "åº”è¯¥æˆåŠŸç™»å½•"

# æŸ¥çœ‹æµ‹è¯•æŠ¥å‘Š
npm run test:e2e:report
```

## ğŸ› ï¸ æŠ€æœ¯å®ç°

### Page Object æ¨¡å¼

```typescript
// AuthPage å°è£…æ‰€æœ‰è®¤è¯ç›¸å…³æ“ä½œ
export class AuthPage {
  async login(email: string, password: string)
  async register(email: string, password: string)
  async logout()
  async getToken()
  async waitForDashboard()
  // ...
}
```

### API è¾…åŠ©å‡½æ•°

```typescript
// ApiHelper ç”¨äºæµ‹è¯•æ•°æ®ç®¡ç†
export class ApiHelper {
  static async createTestUser(email, password)
  static async deleteTestUser(email, token)
  static async getUserToken(email, password)
}
```

### æ•°æ®æ¸…ç†ç­–ç•¥

- **beforeEach**: åˆ›å»ºæµ‹è¯•ç”¨æˆ·
- **afterEach**: åˆ é™¤æµ‹è¯•ç”¨æˆ·
- **åŠ¨æ€é‚®ç®±**: `test-${Date.now()}@example.com` é¿å…å†²çª

## ğŸ“‹ æµ‹è¯•é…ç½®

### playwright.config.ts

```typescript
{
  testDir: './tests/e2e',
  baseURL: 'http://localhost:3000',
  workers: 1,              // ä¸²è¡Œæ‰§è¡Œé¿å…å†²çª
  retries: 0,
  reporter: 'html',
  use: {
    screenshot: 'only-on-failure',
    video: 'retain-on-failure',
    trace: 'on-first-retry',
  }
}
```

## âš ï¸ å·²çŸ¥é™åˆ¶

### OAuth æµ‹è¯•
- åªæµ‹è¯•æŒ‰é’®å­˜åœ¨æ€§å’Œç‚¹å‡»è·³è½¬
- å®Œæ•´æµç¨‹éœ€è¦çœŸå® OAuth é…ç½®
- å»ºè®®ä½¿ç”¨ mock OAuth æœåŠ¡å™¨ç”¨äº CI/CD

### æ•°æ®åº“éªŒè¯
- AUTH-007 å¯†ç åŠ å¯†æµ‹è¯•åªéªŒè¯ API å“åº”
- ç›´æ¥æ•°æ®åº“éªŒè¯éœ€è¦é¢å¤–çš„æµ‹è¯•å·¥å…·

## ğŸ“ˆ ä¸‹ä¸€æ­¥è®¡åˆ’

### éœ€è¦å®ç°çš„ E2E æµ‹è¯•

1. **PROJ æ¨¡å—** - é¡¹ç›®ç®¡ç†
   - åˆ›å»ºé¡¹ç›®
   - é…ç½®æ•°æ®åº“
   - æµ‹è¯•æ•°æ®åº“è¿æ¥

2. **KEYW æ¨¡å—** - å…³é”®å­—é…ç½®
   - æŸ¥çœ‹/ç¼–è¾‘å†…ç½®å…³é”®å­—
   - åˆ›å»ºè‡ªå®šä¹‰å…³é”®å­—
   - Monaco Editor äº¤äº’

3. **INTF æ¨¡å—** - æ¥å£å®šä¹‰
   - å¯¼å…¥ cURL
   - ç¯å¢ƒç®¡ç†
   - å…¨å±€å˜é‡ç®¡ç†

4. **SCEN æ¨¡å—** - åœºæ™¯ç¼–æ’
   - æ‹–æ‹½æ’åº
   - æ·»åŠ æµ‹è¯•æ­¥éª¤
   - é…ç½®å‚æ•°

5. **PLAN æ¨¡å—** - æµ‹è¯•è®¡åˆ’
   - åˆ›å»ºæµ‹è¯•è®¡åˆ’
   - æ‰§è¡Œæµ‹è¯•
   - æŸ¥çœ‹è¿›åº¦

6. **REPT æ¨¡å—** - æµ‹è¯•æŠ¥å‘Š
   - æŸ¥çœ‹æŠ¥å‘Š
   - å¯¼å‡ºæŠ¥å‘Š
   - Allure æŠ¥å‘Š

## âœ… æµ‹è¯•è´¨é‡æ£€æŸ¥æ¸…å•

- [x] ä½¿ç”¨ Page Object æ¨¡å¼
- [x] æµ‹è¯•ç‹¬ç«‹å¯é‡å¤è¿è¡Œ
- [x] æ¯ä¸ªæµ‹è¯•åæ¸…ç†æ•°æ®
- [x] ä½¿ç”¨ beforeEach/afterEach
- [x] éªŒè¯ UI çŠ¶æ€
- [x] éªŒè¯ localStorage
- [x] éªŒè¯é”™è¯¯æ¶ˆæ¯
- [x] ä½¿ç”¨åŠ¨æ€æµ‹è¯•æ•°æ®
- [x] é…ç½®ä¸²è¡Œæ‰§è¡Œ
- [x] å¤±è´¥æ—¶æˆªå›¾/å½•å±
- [x] ç”Ÿæˆ HTML æŠ¥å‘Š
- [x] ç¼–å†™è¯¦ç»†æ–‡æ¡£

## ğŸ“ ä»£ç ç¤ºä¾‹

### åˆ›å»ºæ–° Page Object

```typescript
// tests/e2e/pages/ProjectPage.ts
import { Page, Locator } from '@playwright/test'

export class ProjectPage {
  readonly page: Page
  readonly createButton: Locator
  readonly projectNameInput: Locator

  constructor(page: Page) {
    this.page = page
    this.createButton = page.locator('button:has-text("åˆ›å»ºé¡¹ç›®")')
    this.projectNameInput = page.locator('input[name="projectName"]')
  }

  async goto() {
    await this.page.goto('/projects')
  }

  async createProject(name: string) {
    await this.createButton.click()
    await this.projectNameInput.fill(name)
    await this.page.click('button[type="submit"]')
  }
}
```

### æ·»åŠ æ–°æµ‹è¯•

```typescript
test('åº”è¯¥åˆ›å»ºé¡¹ç›®', async ({ page }) => {
  const projectPage = new ProjectPage(page)

  await projectPage.goto()
  await projectPage.createProject('æµ‹è¯•é¡¹ç›®')

  await expect(page.locator('.project-list')).toContainText('æµ‹è¯•é¡¹ç›®')
})
```

## ğŸ“ å­¦ä¹ èµ„æº

- [Playwright å®˜æ–¹æ–‡æ¡£](https://playwright.dev)
- [Page Object æ¨¡å¼æœ€ä½³å®è·µ](https://playwright.dev/docs/pom)
- [æµ‹è¯•æœ€ä½³å®è·µ](https://playwright.dev/docs/best-practices)

---

**åˆ›å»ºæ—¶é—´**: 2026-02-13
**ç»´æŠ¤è€…**: e2e-auth-tester Agent
**ç‰ˆæœ¬**: 1.0.0
